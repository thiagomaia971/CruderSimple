@using Microsoft.AspNetCore.Components.Forms
@typeparam TGridEntity
@typeparam TGridDto
@inherits ComponentBase

@Dimension?.Width
@((int) (Dimension?.Width * 0.8))
@((int) (Dimension.Width * 0.1))

<Modal @ref="ModalRef" 
       Closing="@ModalClosed"
       Class="cruder-grid-modal">
    @if (ModalFormTemplate != null && CurrentSelected != null)
    {
        <ModalContent Size="ModalSize.ExtraLarge"
                      Width="Blazorise.Width.Px((int) (Dimension.Width * 0.8))"
                      Margin="@(Blazorise.Margin.Is($"{(int) (Dimension.Width * 0.1)}px"))">
            <ModalHeader>
                <h4 style="margin: 0px;">
                    @ModalFormTitle
                </h4>
            </ModalHeader>
            <EditForm class="form-signin" OnValidSubmit="SaveModal" Model="@CurrentSelected">
                <ModalBody>
                    <Row>
                        <Column ColumnSize="ColumnSize.Is12">
                            <Validations @ref="@ValidationsRef" Model="@CurrentSelected" Mode="ValidationMode.Auto" MissingFieldsErrorMessage="Error" ValidateOnLoad="false">
                                <Blazorise.ValidationSummary Label="Segue os erros:" />
                                @ModalFormTemplate(CurrentSelected)
                            </Validations>
                        </Column>
                    </Row>
                </ModalBody>
                <ModalFooter>
                    <Button Color="Color.Warning" Clicked="@(() => ModalRef.Close(CloseReason.UserClosing))">
                        Cancelar
                    </Button>
                    <Button Color="Color.Primary" Type="ButtonType.Submit" Loading="@IsLoading" Disabled="@(!PermissionService.CanWrite || IsLoading)" Margin="Margin.Is1.OnX">
                        @if (IsNewItem)
                        {
                            @("Adicionar")
                        }
                        else
                        {
                            @("Editar")
                        }
                    </Button>
                </ModalFooter>
            </EditForm>
        </ModalContent>
    }
</Modal>